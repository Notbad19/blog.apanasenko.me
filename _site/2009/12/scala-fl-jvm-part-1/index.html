<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru">
	<head>
 	  	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	  	<title>
	    	 Scala FL JVM (part 1)  
	  	</title>
		<link rel="stylesheet" href="/css/style.css" type="text/css" media="all"/>
	</head>
<body>
<div id="header">
	<ul id="nav" class="nav"> 
		<li id="main" class="selected"><a href="/"><strong>Home</strong><span>main page</span></a></li> 
		<li id="post"><a href="/2009/12/scala-fl-jvm-part-1"><strong>Blog</strong> <span>post</span></a></li>
		<li id="archive"><a href="/archive"><strong>Archive</strong></a></li> 
		<li><a href="http://ru.linkedin.com/in/apanasenko/"><strong>LinkedIn</strong> <span>&rarr;</span></a></li> 
		<li><a href="http://github.com/dieu"><strong>Github</strong> <span>&rarr;</span></a></li> 
		<li><a href="http://twitter.com/apanasenko"><strong>Twitter</strong> <span>&rarr;</span></a></li> 
	</ul>
</div>
<div id="container">			
	<div class="bar"> 
	</div> 
	<br/>
	<div id="content">
			<!-- <span id="article_buttons">
  <a id="tweet">
    <span class="balloon">tweet!</span> <img src="/images/tweet.png"/ alt="tweet"/>
  </a>
  <a href="http://feeds.feedburner.com/apanasenko">
    <span class="balloon">subscribe!</span> <img src="/images/feed.png" alt="feed"/> 
  </a>
</span>

<hr/> -->

<div class="content">
	<center><img src="http://lh6.ggpht.com/_wN3Yn5K_LYs/SyTg_KXBQOI/AAAAAAAAAIs/vP10ZF48vtk/newsflash_logo.png?imgmax=800" alt="newsflash_logo.png" width="646" height="93" /></center>
<p>В сегодняшнем хайпе <strong>функциональных языках</strong> программирования <strong>Java</strong> программисты так же как и все испытывают потребность в каком-то языковом сахаре, функциональных плюшках, etc. Но Sun пока не дает всего этого в своём флагманском языке программирования в отличии от конкурентов, она придерживается консервативного подхода (хотя уже есть <a href="http://www.jroller.com/scolebourne/entry/closures_in_jdk_7">подвижки</a>). В следствии всего этого, <strong>Java</strong> программисты смотрят на другие <strong><span class="caps">JVM</span></strong> языки (благо платформа дает все возможности для полета фантазии любого программиста), которые дают все блага описанные выше и многое другое. Один из таких языков это <strong>Scala (SCAlable LAnguage)</strong> — мультипарадигмальный язык программирования, без <strong>С</strong> подобного синтаксиса (с более лакониченым). В нем органично сочетаются возможности функционального и объектно ориентированного программирования.</p>
<h4>История</h4>
<p>Язык был создан в 2001—2004 годах в Лаборатории методов программирования <a href="http://ru.wikipedia.org/wiki/EPFL"><span class="caps">EPFL</span></a>. Автором языка считается <a href="http://people.epfl.ch/martin.odersky">Martin Odersky</a> создатель языка <strong>Pizza</strong>, который стал прототипом <strong>Generic</strong> в <strong>Java</strong>. Он стал результатом исследований, направленных на разработку улучшенной языковой поддержки компонентного ПО. За основу при разработке языка были взяты 2 идеи:</p>
<ol>
	<li>Язык программирования компонентного ПО должен быть масштабируемым в том смысле, что должна быть возможность с помощью одних и тех же концепций описать как маленькие, так и большие части. Поэтому внимание было сконцентрировано на механизмах абстракции, композиции и декомпозиции вместо введения большого количества примитивов, которые могут быть полезными только на каком-то одном уровне масштабирования.</li>
	<li>Масштабируемая поддержка компонентов может быть предоставлена языком программирования, унифицирующим и обобщающим объектно-ориентированное и функциональное программирование. Некоторые из основных технических новшеств Scala — это концепции, представляющие собой сплав этих парадигм программирования. В статически типизированных языках, к которым относится Scala, эти парадигмы до сих пор были почти полностью разделены.</li>
</ol>
<p><strong>Scala</strong> была выпущена для общего пользования на платформе <strong><span class="caps">JVM</span></strong> в январе 2004 года и на платформе <strong>.<span class="caps">NET</span></strong> в июне 2004 года. Планируется продолжить работу над формализацией ключевых аспектов языка и над разработкой оптимизаций, выполняемых компилятором.</p>
<h4>Истоки дизайна</h4>
<p>Конечно, <strong>Scala</strong> впитала значительное число концепций и синтаксических соглашений <strong>Java</strong> и <strong>C#</strong>. Способ выражения свойств во многом заимствован из <strong>Sather</strong>. Из <strong>Smalltalk</strong> взята концепция унифицированной объектной модели. Из <strong>Beta</strong> пришла идея, что всё, включая классы, должно допускать вложенность. Абстрактные типы в <strong>Scala</strong> очень похожи на абстрактные типы сигнатур в <strong><span class="caps">SML</span></strong> и <strong>OCaml</strong>, обобщенные в контексте полноценных компонентов. В некотором смысле <strong>Scala</strong> — это продолжение работы <strong>Pizza</strong>. Как и <strong>Pizza</strong>, <strong>Scala</strong> компилируется под <strong>Java VM</strong>, добавляя функции высшего порядка, сопоставление с образцом, конструкции, которые исходно были созданы в сообществе функционального программирования. В то время как <strong>Pizza</strong> обратно совместима с <strong>Java</strong>, цель <strong>Scala</strong> — всего лишь возможность взаимодействия, так что у нее больше степеней свободы в дизайне. Ещё одна цель <strong>Scala</strong> — предоставить расширенные конструкции для абстракции и композиции компонентов — общая с несколькими недавними исследовательскими разработками.</p>
<h4>Ключевые аспекты языка</h4>
<ol>
	<li>Scala-программы во многом похожи на Java-программы, и могут свободно взаимодействовать с Java-кодом.</li>
	<li>Scala включает единообразную объектную модель — в том смысле, что любое значение является объектом, а любая операция — вызовом метода.</li>
	<li>Scala — это также функциональный язык в том смысле, что функции — это полноправные значения.</li>
	<li>В Scala включены мощные и единообразные концепции абстракций как для типов, так и для значений.</li>
	<li>Она содержит гибкие симметричные конструкции примесей для композиции классов и trait-ов.</li>
	<li>Она позволяет производить декомпозицию объектов путем сравнения с образцом.</li>
	<li>Образцы и выражения были обобщены для поддержки естественной обработки <span class="caps">XML</span>-документов.</li>
	<li>В целом, эти конструкции позволяют легко выражать самостоятельные компоненты, использующие библиотеки Scala, не пользуясь специальными языковыми конструкциями.</li>
	<li>Scala допускает внешние расширения компонентов с использованием видов (views).</li>
	<li>Есть поддержка структурных и экзистенциальных типов.</li>
	<li>На текущий момент Scala реализована на платформах Java и .<span class="caps">NET</span>.</li>
</ol>
<h4>Различия синтаксиса по сравнению с Java</h4>
<ol>
	<li><strong>Hello World и Object</strong>:</li>
</ol>
<div class="highlight"><pre><code class="scala"><span class="k">object</span> <span class="nc">HelloWorld</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">(</span><span class="n">arg</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="n">println</span><span class="o">(</span><span class="s">&quot;Hello, world!&quot;</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div><p>В Scala можно объявить отдельные объекты, которые буду себя вести согласно паттерну <a href="http://ru.wikipedia.org/wiki/Одиночка_(шаблон_проектирования)">Singelton</a>. Из этого листинга видно, что массивы типизируются с помощью <strong>[]</strong>, а не как обычно в <strong>Java, &lt;&gt;</strong>. Доступ к элементам массива происходит через оператор <strong>()</strong></p>
<div class="highlight"><pre><code class="scala"><span class="k">object</span> <span class="nc">HelloWorld</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">(</span><span class="n">arg</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="n">println</span><span class="o">(</span><span class="s">&quot;Hello, world! &quot;</span> <span class="o">+</span> <span class="n">arg</span><span class="o">(</span><span class="mi">0</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div><ol>
	<li><strong>Функции(Методы)</strong>:<br />
Функции как видно из листинга выше объявляются с помощью ключевого слова <strong>def</strong>, так же перед объявлением функции могут быть указаны модификаторы доступа <strong>private, protected</strong> (по умолчанию всем методам выставляется модификатор <strong>public</strong>, который отсутствует в явном виде). Есть еще один интересный момент, с помощью которого можно типизировать модификаторы доступа, как и обычные типы, накладывая тем самым на методы и поля больше ограничений.</li>
</ol>
<div class="highlight"><pre><code class="scala"><span class="k">object</span> <span class="nc">HelloWorld</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">(</span><span class="n">arg</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="n">println</span><span class="o">(</span><span class="n">hello</span> <span class="o">+</span> <span class="n">world</span><span class="o">)</span>
  <span class="o">}</span>
  <span class="k">private</span><span class="o">[</span><span class="kt">HelloWorld</span><span class="o">]</span> <span class="k">def</span> <span class="n">hello</span><span class="o">()</span> <span class="k">=</span> <span class="s">&quot;Hello, &quot;</span>
  <span class="k">protected</span><span class="o">[</span><span class="kt">this</span><span class="o">]</span> <span class="k">def</span> <span class="n">world</span><span class="o">()</span> <span class="k">=</span> <span class="s">&quot;World!&quot;</span>
<span class="o">}</span>
</code></pre>
</div><p>Так же в <strong>Scala</strong> методы и операторы однозначны, т.е. в <strong>Scala</strong> по сравнению с <strong>Java</strong> появилась возможность перегрузки операторов.</p>
<div class="highlight"><pre><code class="scala"><span class="k">class</span> <span class="nc">Complex</span><span class="o">(</span><span class="n">r</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">i</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">real</span> <span class="k">=</span> <span class="n">r</span>
  <span class="k">def</span> <span class="n">image</span> <span class="k">=</span> <span class="n">i</span>
  <span class="k">def</span> <span class="n">magnitude</span> <span class="k">=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">sqrt</span><span class="o">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">r</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="o">)</span>
  <span class="k">def</span> <span class="n">angle</span> <span class="k">=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">atan2</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">r</span><span class="o">)</span>
  <span class="k">def</span> <span class="o">+(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Complex</span><span class="o">)</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Complex</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="n">real</span> <span class="o">+</span> <span class="n">that</span><span class="o">.</span><span class="n">real</span><span class="o">,</span> <span class="k">this</span><span class="o">.</span><span class="n">image</span> <span class="o">+</span> <span class="n">that</span><span class="o">.</span><span class="n">image</span><span class="o">)</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span> <span class="k">=</span> <span class="n">real</span> <span class="o">+</span> <span class="s">&quot; + i*&quot;</span> <span class="o">+</span> <span class="n">image</span> <span class="o">+</span> <span class="s">&quot; | &quot;</span> <span class="o">+</span> <span class="n">magnitude</span> <span class="o">+</span> <span class="s">&quot;*e^(i*&quot;</span> <span class="o">+</span> <span class="n">angle</span> <span class="o">+</span> <span class="s">&quot;))&quot;</span>
<span class="o">}</span>
</code></pre>
</div><p>Модификатор <strong>override</strong>, как уже можно было заметить обязателен когда вы хотите перегрузить метод.</p>
<ol>
	<li><strong>Классы</strong>:</li>
</ol>
<div class="highlight"><pre><code class="scala"><span class="k">class</span> <span class="nc">Point2d</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Float</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Float</span><span class="o">)</span> <span class="o">{</span> 
  <span class="k">def</span> <span class="n">length</span> <span class="k">=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">sqrt</span><span class="o">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">,</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="o">)</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span> <span class="k">=</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s">&quot;, &quot;</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
<span class="o">}</span>
</code></pre>
</div><p>Как видно из листинга примера, объявление класса отличается от Java, сразу рядом с названием можно объявить &#8220;простой&#8221; конструктор, тем самым сохранив начальные поля класса, но так же существует и способ объявления конструктора обычным способом.</p>
<div class="highlight"><pre><code class="scala"><span class="k">class</span> <span class="nc">Point2d</span> <span class="o">{</span> 
  <span class="k">var</span> <span class="n">x</span><span class="k">:</span> <span class="kt">Float</span> 
  <span class="k">var</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Float</span> 
  <span class="k">def</span> <span class="k">this</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Float</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Float</span><span class="o">)</span> <span class="o">{</span> 
 <span class="k">this</span><span class="o">.</span><span class="n">x</span> <span class="k">=</span> <span class="n">x</span><span class="o">;</span> <span class="k">this</span><span class="o">.</span><span class="n">y</span> <span class="k">=</span> <span class="n">y</span>
  <span class="o">}</span> 
  <span class="k">def</span> <span class="n">length</span> <span class="k">=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">sqrt</span><span class="o">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">,</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="o">)</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span> <span class="k">=</span> <span class="err">”</span><span class="o">(</span><span class="err">”</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="err">”</span><span class="o">,</span> <span class="err">”</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="err">”</span><span class="o">)</span><span class="err">”</span>
<span class="o">}</span> 
</code></pre>
</div><p>Из этого листинга так же видно, что &#8220;;&#8221; не обязательный знак как в Java, а применяется только тогда когда надо явно указать разделение операций, в остальных случаях достаточно перевода строки. Так же видно, что для указания типа используется &#8220;:&#8221; как у переменных, так и у методов. Так же у переменных существуют модификаторы <strong>var</strong> и <strong>val</strong>, которые делают переменные изменяемыми и не изменяемыми соответственно.</p>
<ol>
	<li><strong>Traits</strong>:</li>
</ol>
<p>Trait — это интерфейс, который может содержать реализации методов, но не может содержать поля. В этом смысле в Scala есть множественное наследование.</p>
<div class="highlight"><pre><code class="scala"><span class="k">trait</span> <span class="nc">Comparable</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span> 
  <span class="k">def</span> <span class="n">compareTo</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> 
  <span class="k">def</span> <span class="o">&gt;(</span><span class="n">that</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=</span> <span class="n">compareTo</span><span class="o">(</span><span class="n">that</span><span class="o">)</span> <span class="o">&gt;</span> <span class="mi">0</span> 
  <span class="k">def</span> <span class="o">&gt;=(</span><span class="n">that</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=</span> <span class="n">compareTo</span><span class="o">(</span><span class="n">that</span><span class="o">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> 
  <span class="k">def</span> <span class="o">==(</span><span class="n">that</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=</span> <span class="n">compareTo</span><span class="o">(</span><span class="n">that</span><span class="o">)</span> <span class="o">==</span> <span class="mi">0</span> 
  <span class="k">def</span> <span class="o">&lt;(</span><span class="n">that</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=</span> <span class="n">compareTo</span><span class="o">(</span><span class="n">that</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span> 
  <span class="k">def</span> <span class="o">&lt;=(</span><span class="n">that</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=</span> <span class="n">compareTo</span><span class="o">(</span><span class="n">that</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="mi">0</span>
<span class="o">}</span>
<span class="k">class</span> <span class="nc">Fraction</span><span class="o">(</span><span class="n">num</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">denom</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Comparable</span><span class="o">[</span><span class="kt">Fraction</span><span class="o">]</span> <span class="o">{</span> 
  <span class="k">def</span> <span class="n">compareTo</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Fraction</span><span class="o">)</span> <span class="k">=</span> <span class="k">this</span><span class="o">.</span><span class="n">num</span> <span class="o">*</span> <span class="n">that</span><span class="o">.</span><span class="n">denom</span> <span class="o">-</span> <span class="n">that</span><span class="o">.</span><span class="n">num</span> <span class="o">*</span> <span class="k">this</span><span class="o">.</span><span class="n">denom</span>
<span class="o">}</span> 
<span class="k">new</span> <span class="nc">Fraction</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span> <span class="o">&gt;</span> <span class="k">new</span> <span class="nc">Fraction</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span> <span class="c1">// возвращает true</span>
</code></pre>
</div><ol>
	<li><strong>Mixin</strong>:</li>
</ol>
<div class="highlight"><pre><code class="scala"><span class="k">object</span> <span class="nc">Pets</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">(</span><span class="n">arg</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
    <span class="n">println</span><span class="o">(</span><span class="k">new</span> <span class="nc">Pet</span><span class="o">(</span><span class="s">&quot;Martin&quot;</span><span class="o">))</span> <span class="c1">//Martin</span>
    <span class="n">println</span><span class="o">(</span><span class="k">new</span> <span class="nc">Pet</span><span class="o">(</span><span class="s">&quot;Martin&quot;</span><span class="o">)</span> <span class="k">with</span> <span class="nc">PetName</span><span class="o">)</span> <span class="c1">//Name: Martin</span>
  <span class="o">}</span>
<span class="o">}</span>
<span class="k">class</span> <span class="nc">Pet</span><span class="o">(</span><span class="k">val</span> <span class="n">name</span><span class="k">:</span><span class="kt">String</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span> <span class="k">=</span> <span class="n">name</span>
<span class="o">}</span>
<span class="k">trait</span> <span class="nc">PetName</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">toString</span> <span class="k">=</span> <span class="s">&quot;Name: &quot;</span> <span class="o">+</span> <span class="k">super</span><span class="o">.</span><span class="n">toString</span>
<span class="o">}</span>
</code></pre>
</div><h4>Небольшой пример</h4>
<p>На <strong>Java</strong>:</p>
<div class="highlight"><pre><code class="scala"><span class="n">public</span> <span class="k">class</span> <span class="nc">QuicksortJava</span> <span class="o">{</span>
    <span class="k">private</span> <span class="n">static</span> <span class="n">void</span> <span class="n">doSort</span><span class="o">(</span><span class="n">int</span> <span class="n">start</span><span class="o">,</span> <span class="n">int</span> <span class="n">end</span><span class="o">,</span> <span class="n">int</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">end</span><span class="o">)</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="n">int</span> <span class="n">i</span> <span class="k">=</span> <span class="n">start</span><span class="o">,</span> <span class="n">j</span> <span class="k">=</span> <span class="n">end</span><span class="o">;</span>
        <span class="n">int</span> <span class="n">cur</span> <span class="k">=</span> <span class="n">i</span> <span class="o">-</span> <span class="o">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span><span class="o">)</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">cur</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">array</span><span class="o">[</span><span class="kt">i</span><span class="o">]</span> <span class="o">&lt;=</span> <span class="n">array</span><span class="o">[</span><span class="kt">cur</span><span class="o">]))</span> <span class="o">{</span>
                <span class="n">i</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="n">cur</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">array</span><span class="o">[</span><span class="kt">cur</span><span class="o">]</span> <span class="o">&lt;=</span> <span class="n">array</span><span class="o">[</span><span class="kt">j</span><span class="o">]))</span> <span class="o">{</span>
                <span class="n">j</span><span class="o">--;</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">int</span> <span class="n">temp</span> <span class="k">=</span> <span class="n">array</span><span class="o">[</span><span class="kt">i</span><span class="o">];</span>
                <span class="n">array</span><span class="o">[</span><span class="kt">i</span><span class="o">]</span> <span class="k">=</span> <span class="n">array</span><span class="o">[</span><span class="kt">j</span><span class="o">];</span>
                <span class="n">array</span><span class="o">[</span><span class="kt">j</span><span class="o">]</span> <span class="k">=</span> <span class="n">temp</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">cur</span><span class="o">)</span>
                    <span class="n">cur</span> <span class="k">=</span> <span class="n">j</span><span class="o">;</span>
                <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">j</span> <span class="o">==</span> <span class="n">cur</span><span class="o">)</span>
                    <span class="n">cur</span> <span class="k">=</span> <span class="n">i</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">doSort</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">cur</span><span class="o">,</span> <span class="n">array</span><span class="o">);</span>
        <span class="n">doSort</span><span class="o">(</span><span class="n">cur</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">end</span><span class="o">,</span> <span class="n">array</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="n">public</span> <span class="n">void</span> <span class="n">sort</span><span class="o">(</span><span class="n">int</span><span class="o">[]</span> <span class="n">xs</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">doSort</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">xs</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">xs</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">int</span><span class="o">[]</span> <span class="n">xs</span> <span class="k">=</span> <span class="k">new</span> <span class="n">int</span><span class="o">[]{</span><span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">};</span>
        <span class="k">new</span> <span class="nc">QuicksortJava</span><span class="o">().</span><span class="n">sort</span><span class="o">(</span><span class="n">xs</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="n">toString</span><span class="o">(</span><span class="n">xs</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div><p>и <strong>Scala</strong>:</p>
<div class="highlight"><pre><code class="scala"><span class="k">object</span> <span class="nc">Quicksort</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">sort</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">xs</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="o">)</span> <span class="n">xs</span>
    <span class="k">else</span> <span class="o">{</span>
      <span class="k">val</span> <span class="n">pivot</span> <span class="k">=</span> <span class="n">xs</span><span class="o">(</span><span class="n">xs</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">2</span><span class="o">)</span>
      <span class="nc">Array</span><span class="o">.</span><span class="n">concat</span><span class="o">(</span>
        <span class="n">sort</span><span class="o">(</span><span class="n">xs</span> <span class="n">filter</span> <span class="o">(</span><span class="n">pivot</span> <span class="o">&gt;)),</span>
        <span class="n">xs</span> <span class="n">filter</span> <span class="o">(</span><span class="n">pivot</span> <span class="o">==),</span>
        <span class="n">sort</span><span class="o">(</span><span class="n">xs</span> <span class="n">filter</span> <span class="o">(</span><span class="n">pivot</span> <span class="o">&lt;)))</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="n">main</span><span class="o">(</span><span class="n">arg</span><span class="k">:</span><span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">xs</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>
    <span class="n">println</span><span class="o">(</span><span class="n">sort</span><span class="o">(</span><span class="n">xs</span><span class="o">).</span><span class="n">toString</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

	
		<h4>Posted 13 Dec 2009 by Anton Panasenko | tags:
		 
			
				<a href="/search/label/fl">fl</a>,
			 
		 
			
				<a href="/search/label/fp">fp</a>,
			 
		 
					
				<a href="/search/label/jvm">jvm</a>
			 
		 
			
				and <a href="/search/label/scala">scala</a>.
			 
		
	</h4>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = 'http://dieu.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript">
	$('#main').removeClass('selected');
	$('#post').addClass('selected');
</script>

<!--

-->

	</div>
</div>
<!-- <div id="footer">
	<a href="">Source code</a>
</div> -->

 <script type="text/javascript">
var disqus_shortname = 'dieu';
(function () {
    var s = document.createElement('script'); s.async = true;
    s.src = 'http://disqus.com/forums/dieu/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
 </script>

  
<!-- Yandex.Metrika counter -->
<div style="display:none;"><script type="text/javascript">
(function(w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter445478 = new Ya.Metrika(445478);
             yaCounter445478.clickmap(true);
             yaCounter445478.trackLinks(true);
        
        } catch(e) { }
    });
})(window, 'yandex_metrika_callbacks');
</script></div>
<script src="//mc.yandex.ru/metrika/watch.js" type="text/javascript" defer="defer"></script>
<noscript><img src="//mc.yandex.ru/watch/445478" style="position:absolute; left:-9999px;" alt="" /></noscript>
<!-- /Yandex.Metrika counter -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6891853-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>