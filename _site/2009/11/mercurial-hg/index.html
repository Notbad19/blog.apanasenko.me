<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru">
	<head>
 	  	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	  	<title>
	    	 Mercurial Hg  
	  	</title>
		<link rel="stylesheet" href="/css/style.css" type="text/css" media="all"/>
	</head>
<body>
<div id="header">
	<ul id="nav" class="nav"> 
		<li id="main" class="selected"><a href="/"><strong>Home</strong><span>main page</span></a></li> 
		<li id="post"><a href="/2009/11/mercurial-hg"><strong>Blog</strong> <span>post</span></a></li>
		<li id="archive"><a href="/archive"><strong>Archive</strong></a></li> 
		<li><a href="http://ru.linkedin.com/in/apanasenko/"><strong>LinkedIn</strong> <span>&rarr;</span></a></li> 
		<li><a href="http://github.com/dieu"><strong>Github</strong> <span>&rarr;</span></a></li> 
		<li><a href="http://twitter.com/apanasenko"><strong>Twitter</strong> <span>&rarr;</span></a></li> 
	</ul>
</div>
<div id="container">			
	<div class="bar"> 
	</div> 
	<br/>
	<div id="content">
			<!-- <span id="article_buttons">
  <a id="tweet">
    <span class="balloon">tweet!</span> <img src="/images/tweet.png"/ alt="tweet"/>
  </a>
  <a href="http://feeds.feedburner.com/apanasenko">
    <span class="balloon">subscribe!</span> <img src="/images/feed.png" alt="feed"/> 
  </a>
</span>

<hr/> -->

<div class="content">
	<p><strong><span class="caps">DVCS</span></strong> (Distributed Version Control System) &#8211; это распределенные системы контроля версий, которые в общем случае не нуждаются в централизованном хранилище. Это их главное преимущество перед традиционными системами (<span class="caps">CVS</span>, <span class="caps">SVN</span>, etc), оно начинает проявляться и выручать при достаточно большой и распределенной команде разработчиков. Это очень удобно когда можно работать без доступа к центральному репозиторию или когда есть возможность делиться своими &#8220;экспериментальными&#8221; на работками с другими участниками разработки. Известные представители этого семейства:</p>
<ol>
	<li>Darcs;</li>
	<li>BitKeeper;</li>
	<li>Bazaar;</li>
	<li>Git;</li>
	<li>Mercurial.</li>
</ol>
<h4>Mercurial</h4>
<center><img src="http://lh6.ggpht.com/_wN3Yn5K_LYs/Sv9RZPG2API/AAAAAAAAACs/I0Qq9icgvCA/Mercurial_logo.png?imgmax=800" alt="Mercurial_logo.png" width="200" height="240" /></center>
<p><strong>Mercurial</strong> популярная система контроля версий, список использующих в качестве основной системы контроля версий достаточно впечатляющий:</p>
<ol>
	<li>Mozilla</li>
	<li>OpenOffice.org</li>
	<li>OpenJDK</li>
	<li>Netbeans</li>
	<li>OpenSolaris</li>
	<li><span class="caps">ALSA</span></li>
	<li>Xen</li>
	<li>Dovecot</li>
	<li>MoinMoin</li>
	<li><span class="caps">XINE</span></li>
	<li>wmii и dwm</li>
	<li>mutt</li>
	<li>XEmacs</li>
	<li><span class="caps">NTFS</span>-3G</li>
	<li>Adium</li>
	<li>Gajim</li>
	<li>Python</li>
	<li>RabbitMQ</li>
</ol>
<p>Бесплатные хостинги проектов:</p>
<ol>
	<li>Google Code</li>
	<li>Assembla.com</li>
	<li>BitBucket.org</li>
</ol>
<p>Mercurial написан на Python&#8217;e, но особо узкие места были переписаны в виде Python-C расширений. Hg умеет работать поверх протоколов <span class="caps">HTTP</span>/<span class="caps">HTTPS</span> и <span class="caps">SSH</span>. Локальный сервер репозитория очень лекго умеет подниматься с помощью команды hg serve в корне локального репозитория (сервер поднимается на порту 8000). Из личного опыта Mercurail очень производителен и легок в обращении, за счет основы в виде Python&#8217;a отлично интегрируется во все популярные платформы. Так же имеет кросплатформенный <span class="caps">GUI</span> клиент <a href="http://bitbucket.org/tortoisehg/stable/wiki/Home">TortoiseHg</a>, который интегрируется как в Windows, так и в Gnome/Nautilus.</p>
<h4>Основные команды</h4>
<div class="highlight"><pre><code class="bash">hg clone <span class="o">[</span>address<span class="o">]</span>
</code></pre>
</div><p>Для создания рабочей копии.</p>
<div class="highlight"><pre><code class="bash">hg pull <span class="o">[</span>address<span class="o">]</span>
</code></pre>
</div><p>Для скачивания последней ревизии.</p>
<div class="highlight"><pre><code class="bash">hg add <span class="o">[</span>file<span class="o">]</span>
</code></pre>
</div><p>Для добавления файла в новый коммит.</p>
<div class="highlight"><pre><code class="bash">hg push <span class="o">[</span>address<span class="o">]</span>
</code></pre>
</div><p>Для добавления последних коммитов в удаленный репозиторий.</p>
<div class="highlight"><pre><code class="bash">hg commit
</code></pre>
</div><p>Для добавления нового коммита в рабочую копию.</p>
<div class="highlight"><pre><code class="bash">hg merge
</code></pre>
</div><p>Для мержа конфликтов.</p>
<div class="highlight"><pre><code class="bash">hg resolve
</code></pre>
</div><p>Для возврата к последнему валидному коммиту после не удачного мержа.</p>
<div class="highlight"><pre><code class="bash">hg up
</code></pre>
</div><p>Для обновления рабочей копии.</p>
<h4>Плагины</h4>
<p>Для установки плагинов достаточно записать строку с названием после [extensions] в файл .hgrc (в корне домашней директории).</p>
<p>fetch — выполняет обновление рабочей копии, merge (если нет конфликтов) и commit.</p>
<div class="highlight"><pre><code class="bash"><span class="nv">fetch</span> <span class="o">=</span> 
</code></pre>
</div><p>purge — отчищает все файлы, которые не были добавлены в рабочую копию (commit)</p>
<div class="highlight"><pre><code class="bash"><span class="nv">purge</span> <span class="o">=</span> 
</code></pre>
</div><p>color — раскрашивает вывод команд</p>
<div class="highlight"><pre><code class="bash"><span class="nv">color</span> <span class="o">=</span> 
</code></pre>
</div><p>churn — добавляет не которые метрики по вашему репозиторию.</p>
<div class="highlight"><pre><code class="bash"><span class="nv">churn</span> <span class="o">=</span> 
</code></pre>
</div><p>Так же надо добавить</p>
<div class="highlight"><pre><code class="bash"><span class="nv">churn</span> <span class="o">=</span> --progress
</code></pre>
</div><p>в [defaults] секцию</p>
<p>graphlog — дает возможность получить графическое представление лога репозитория</p>
<div class="highlight"><pre><code class="bash"><span class="nv">graphlog</span> <span class="o">=</span> 
</code></pre>
</div><p>Для работы локального репозитория без ssl не обходимо добавить</p>
<div class="highlight"><pre><code class="bash"><span class="o">[</span>web<span class="o">]</span>
<span class="nv">allow_push</span> <span class="o">=</span> *
<span class="nv">push_ssl</span> <span class="o">=</span> <span class="nb">false</span> 
</code></pre>
</div><p>в ~/.hgrc файл.</p>
<h4>Пример файла .hgrc</h4>
<div class="highlight"><pre><code class="bash"><span class="o">[</span>auth<span class="o">]</span>
project.prefix <span class="o">=</span> <span class="o">[</span>address<span class="o">]</span>
project.username <span class="o">=</span> <span class="o">[</span>username<span class="o">]</span>
project.password <span class="o">=</span> <span class="o">[</span>password<span class="o">]</span>
project.schemes <span class="o">=</span> http https

<span class="o">[</span>ui<span class="o">]</span>
<span class="nv">username</span> <span class="o">=</span> <span class="s2">&quot;Anton Panasenko&quot;</span>
<span class="nv">style</span> <span class="o">=</span> compact

<span class="o">[</span>defaults<span class="o">]</span>
<span class="nv">branches</span> <span class="o">=</span> --active
<span class="nv">churn</span> <span class="o">=</span> --progress

<span class="o">[</span>extensions<span class="o">]</span>
<span class="nv">churn</span> <span class="o">=</span>
<span class="nv">color</span> <span class="o">=</span>
<span class="nv">graphlog</span> <span class="o">=</span>
<span class="nv">fetch</span> <span class="o">=</span> 
<span class="nv">purge</span> <span class="o">=</span> 
<span class="nv">pager</span> <span class="o">=</span> 
<span class="nv">rebase</span> <span class="o">=</span> 

<span class="o">[</span>pager<span class="o">]</span>
<span class="nv">attend</span> <span class="o">=</span> log, glog
</code></pre>
</div>

	
		<h4>Posted 15 Nov 2009 by Anton Panasenko | tags:
		 
			
				<a href="/search/label/dvcs">dvcs</a>,
			 
		 
					
				<a href="/search/label/hg">hg</a>
			 
		 
			
				and <a href="/search/label/mercurial">mercurial</a>.
			 
		
	</h4>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = 'http://dieu.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript">
	$('#main').removeClass('selected');
	$('#post').addClass('selected');
</script>

<!--

-->

	</div>
</div>
<!-- <div id="footer">
	<a href="">Source code</a>
</div> -->

 <script type="text/javascript">
var disqus_shortname = 'dieu';
(function () {
    var s = document.createElement('script'); s.async = true;
    s.src = 'http://disqus.com/forums/dieu/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
 </script>

  
<!-- Yandex.Metrika counter -->
<div style="display:none;"><script type="text/javascript">
(function(w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter445478 = new Ya.Metrika(445478);
             yaCounter445478.clickmap(true);
             yaCounter445478.trackLinks(true);
        
        } catch(e) { }
    });
})(window, 'yandex_metrika_callbacks');
</script></div>
<script src="//mc.yandex.ru/metrika/watch.js" type="text/javascript" defer="defer"></script>
<noscript><img src="//mc.yandex.ru/watch/445478" style="position:absolute; left:-9999px;" alt="" /></noscript>
<!-- /Yandex.Metrika counter -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6891853-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>