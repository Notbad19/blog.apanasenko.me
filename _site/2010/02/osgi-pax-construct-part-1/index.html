<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru">
	<head>
 	  	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	  	<title>
	    	 OSGI Pax Constructor  
	  	</title>
		<link rel="stylesheet" href="/css/style.css" type="text/css" media="all"/>
	</head>
<body>
<div id="header">
	<ul id="nav" class="nav"> 
		<li id="main" class="selected"><a href="/"><strong>Home</strong><span>main page</span></a></li> 
		<li id="post"><a href="/2010/02/osgi-pax-construct-part-1"><strong>Blog</strong> <span>post</span></a></li>
		<li id="archive"><a href="/archive"><strong>Archive</strong></a></li> 
		<li><a href="http://ru.linkedin.com/in/apanasenko/"><strong>LinkedIn</strong> <span>&rarr;</span></a></li> 
		<li><a href="http://github.com/dieu"><strong>Github</strong> <span>&rarr;</span></a></li> 
		<li><a href="http://twitter.com/apanasenko"><strong>Twitter</strong> <span>&rarr;</span></a></li> 
	</ul>
</div>
<div id="container">			
	<div class="bar"> 
	</div> 
	<br/>
	<div id="content">
			<!-- <span id="article_buttons">
  <a id="tweet">
    <span class="balloon">tweet!</span> <img src="/images/tweet.png"/ alt="tweet"/>
  </a>
  <a href="http://feeds.feedburner.com/apanasenko">
    <span class="balloon">subscribe!</span> <img src="/images/feed.png" alt="feed"/> 
  </a>
</span>

<hr/> -->

<div class="content">
	<center><img alt="pax-construct.png" height="278" src="http://lh3.ggpht.com/_wN3Yn5K_LYs/S4qgrm96rhI/AAAAAAAAALs/8oaJzXA9RLE/pax-construct.png?imgmax=800" width="417" /></center>
<p>Сегодня хотел бы рассказать о таком инструменте, как <a href="http://wiki.ops4j.org/display/paxconstruct/Pax+Construct">Pax Construct</a>. Это фактически индустриальный стандарт для ведения проектов на основе технологии <b>OSGi</b>. Он доступен как <a href="http://wiki.ops4j.org/display/paxconstruct/Download">стандэлон приложение</a>, так и как плагин для <a href="http://www.ops4j.org/projects/pax/construct/">maven2</a>. <b>Pax Construct</b> предоставляет вам множество инструментов для проектов на основе OSGi, которые помогут вам быстро создавать и управлять вашим проектом. Основная функциональность обеспечивается за счет гибкой архитектуры и интеграции с <b>maven2</b>, что улучшает и упрощает процесс сборки OSGi проектов под Maven, так же доступные основные архетипы для новых проектов.</p>
<p>Есть несколько основных команд для работы с Pax Construct:</p>
<ol>
	<li>pax-create-project</li>
	<li>pax-add-repository</li>
	<li>pax-create-module</li>
	<li>pax-create-bundle</li>
	<li>pax-provision</li>
	<li>pax-import-bundle</li>
	<li>pax-embed-jar</li>
	<li>pax-wrap-jar</li>
	<li>pax-move-bundle</li>
	<li>pax-remove-bundle</li>
	<li>pax-clone</li>
</ol>
<h3>Pax create project</h3>
<p>Давайте попробуем рассмотреть данные команды по ближе. Первой командой создадим &#8220;рыбу&#8221; для нового проекта:</p>
<div class="highlight"><pre><code class="bash">home:paxtest apanasenko<span class="nv">$ </span>/opt/pax-construct-1.4/bin/pax-create-project
pax-create-project -g groupId -a artifactId <span class="o">[</span>-v version<span class="o">]</span> <span class="o">[</span>-o<span class="o">]</span> <span class="o">[</span>-- mvnOpts ...<span class="o">]</span>

groupId <span class="o">(</span>examples<span class="o">)</span> ? info.jprogers.pax
artifactId <span class="o">(</span>myProject<span class="o">)</span> ? pax-test
version <span class="o">(</span>1.0-SNAPSHOT<span class="o">)</span> ? 

<span class="o">[</span>INFO<span class="o">]</span> Scanning <span class="k">for </span>projects...
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Building Maven Default Project
<span class="o">[</span>INFO<span class="o">]</span>    task-segment: <span class="o">[</span>org.ops4j:maven-pax-plugin:1.4:create-project<span class="o">]</span> <span class="o">(</span>aggregator-style<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Setting property: classpath.resource.loader.class <span class="o">=</span>&gt; <span class="s1">&#39;org.codehaus.plexus.velocity.ContextClassLoaderResourceLoader&#39;</span>.
<span class="o">[</span>INFO<span class="o">]</span> Setting property: velocimacro.messages.on <span class="o">=</span>&gt; <span class="s1">&#39;false&#39;</span>.
<span class="o">[</span>INFO<span class="o">]</span> Setting property: resource.loader <span class="o">=</span>&gt; <span class="s1">&#39;classpath&#39;</span>.
<span class="o">[</span>INFO<span class="o">]</span> Setting property: resource.manager.logwhenfound <span class="o">=</span>&gt; <span class="s1">&#39;false&#39;</span>.
<span class="o">[</span>INFO<span class="o">]</span> ************************************************************** 
<span class="o">[</span>INFO<span class="o">]</span> Starting Jakarta Velocity v1.4
<span class="o">[</span>INFO<span class="o">]</span> RuntimeInstance initializing.
<span class="o">[</span>INFO<span class="o">]</span> Default Properties File: org/apache/velocity/runtime/defaults/velocity.properties
<span class="o">[</span>INFO<span class="o">]</span> Default ResourceManager initializing. <span class="o">(</span>class org.apache.velocity.runtime.resource.ResourceManagerImpl<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> Resource Loader Instantiated: org.codehaus.plexus.velocity.ContextClassLoaderResourceLoader
<span class="o">[</span>INFO<span class="o">]</span> ClasspathResourceLoader : initialization starting.
<span class="o">[</span>INFO<span class="o">]</span> ClasspathResourceLoader : initialization complete.
<span class="o">[</span>INFO<span class="o">]</span> ResourceCache : initialized. <span class="o">(</span>class org.apache.velocity.runtime.resource.ResourceCacheImpl<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> Default ResourceManager initialization complete.
<span class="o">[</span>INFO<span class="o">]</span> Loaded System Directive: org.apache.velocity.runtime.directive.Literal
<span class="o">[</span>INFO<span class="o">]</span> Loaded System Directive: org.apache.velocity.runtime.directive.Macro
<span class="o">[</span>INFO<span class="o">]</span> Loaded System Directive: org.apache.velocity.runtime.directive.Parse
<span class="o">[</span>INFO<span class="o">]</span> Loaded System Directive: org.apache.velocity.runtime.directive.Include
<span class="o">[</span>INFO<span class="o">]</span> Loaded System Directive: org.apache.velocity.runtime.directive.Foreach
<span class="o">[</span>INFO<span class="o">]</span> Created: 20 parsers.
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : initialization starting.
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : adding VMs from VM library template : VM_global_library.vm
<span class="o">[</span>ERROR<span class="o">]</span> ResourceManager : unable to find resource <span class="s1">&#39;VM_global_library.vm&#39;</span> in any resource loader.
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : error using  VM library template VM_global_library.vm : org.apache.velocity.exception.ResourceNotFoundException: Unable to find resource <span class="s1">&#39;VM_global_library.vm&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro :  VM library template macro registration complete.
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : <span class="nv">allowInline</span> <span class="o">=</span> <span class="nb">true</span> : VMs can be defined inline in templates
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : <span class="nv">allowInlineToOverride</span> <span class="o">=</span> <span class="nb">false</span> : VMs defined inline may NOT replace previous VM definitions
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : <span class="nv">allowInlineLocal</span> <span class="o">=</span> <span class="nb">false</span> : VMs defined inline will be  global in scope <span class="k">if </span>allowed.
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : initialization complete.
<span class="o">[</span>INFO<span class="o">]</span> Velocity successfully started.
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span>pax:create-project <span class="o">{</span>execution: default-cli<span class="o">}]</span>
<span class="o">[</span>INFO<span class="o">]</span> Selecting latest archetype release within version range <span class="o">[</span>1,2<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> artifact org.ops4j.pax.construct:maven-archetype-osgi-project: checking <span class="k">for </span>updates from central
Downloading: http://repo1.maven.org/maven2/org/ops4j/pax/construct/maven-archetype-osgi-project/1.0.3/maven-archetype-osgi-project-1.0.3.jar

<span class="o">[</span>INFO<span class="o">]</span> ----------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Using following parameters <span class="k">for </span>creating Archetype: maven-archetype-osgi-project:1.0.3
<span class="o">[</span>INFO<span class="o">]</span> ----------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Parameter: packageName, Value: info.jprogers.pax.test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: archetypeVersion, Value: 1.0.3
<span class="o">[</span>INFO<span class="o">]</span> Parameter: groupId, Value: info.jprogers.pax
<span class="o">[</span>INFO<span class="o">]</span> Parameter: archetypeArtifactId, Value: maven-archetype-osgi-project
<span class="o">[</span>INFO<span class="o">]</span> Parameter: version, Value: 1.0-SNAPSHOT
<span class="o">[</span>INFO<span class="o">]</span> Parameter: archetypeGroupId, Value: org.ops4j.pax.construct
<span class="o">[</span>INFO<span class="o">]</span> Parameter: basedir, Value: /Users/apanasenko/Documents/IdeaProject/paxtest
<span class="o">[</span>INFO<span class="o">]</span> Parameter: package, Value: info.jprogers.pax.test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: artifactId, Value: pax-test
<span class="o">[</span>INFO<span class="o">]</span> ********************* End of debug info from resources from generated POM ***********************
<span class="o">[</span>INFO<span class="o">]</span> Archetype created in dir: /Users/apanasenko/Documents/IdeaProject/paxtest/pax-test
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> BUILD SUCCESSFUL
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Total <span class="nb">time</span>: 9 seconds
<span class="o">[</span>INFO<span class="o">]</span> Finished at: Sun Feb 28 18:59:50 MSK 2010
<span class="o">[</span>INFO<span class="o">]</span> Final Memory: 16M/79M
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
</code></pre>
</div><p>Эта команда нам создает папку с проектом:</p>
<div class="highlight"><pre><code class="bash">home:paxtest apanasenko<span class="nv">$ </span>ls -al
total 0
drwxr-xr-x   3 apanasenko  staff   102 28 фев 18:59 .
drwxr-xr-x  37 apanasenko  staff  1258 28 фев 18:49 ..
drwxr-xr-x   5 apanasenko  staff   170 28 фев 18:59 pax-test
home:paxtest apanasenko<span class="nv">$ </span><span class="nb">cd </span>pax-test/
home:pax-test apanasenko<span class="nv">$ </span>ls -al
total 8
drwxr-xr-x  5 apanasenko  staff   170 28 фев 18:59 .
drwxr-xr-x  3 apanasenko  staff   102 28 фев 18:59 ..
-rw-r--r--  1 apanasenko  staff  1912 28 фев 18:59 pom.xml
drwxr-xr-x  5 apanasenko  staff   170 28 фев 18:59 poms
drwxr-xr-x  3 apanasenko  staff   102 28 фев 18:59 provision
</code></pre>
</div><p>В которой сразу создана рутовая pom.xml и два идеологических модуля:</p>
<div class="highlight"><pre><code class="bash">home:pax-test apanasenko<span class="nv">$ </span><span class="nb">cd </span>poms/
home:poms apanasenko<span class="nv">$ </span>ls -al
total 8
drwxr-xr-x  5 apanasenko  staff   170 28 фев 18:59 .
drwxr-xr-x  5 apanasenko  staff   170 28 фев 18:59 ..
drwxr-xr-x  3 apanasenko  staff   102 28 фев 18:59 compiled
-rw-r--r--  1 apanasenko  staff  2286 28 фев 18:59 pom.xml
drwxr-xr-x  3 apanasenko  staff   102 28 фев 18:59 wrappers
</code></pre>
</div><p>Первый модуль, который в себе инкапсулирует врапнутые бандлы(бандлы, которые вы создали сами из обычных java библиотек) в модуле <b>wrappers</b>. И содержит в себе один из главных артефактов в модуле <b>compiled</b>, который наследуется всеми модулями (которые на выходе имеют бандлы), в нем в частности содержаться настройки bnd плагина.<br />
Второй модуль содержит в себе все импортируемые депенденси для вашего проекта.</p>
<h3>Pax add repository</h3>
<p>С помощью команды pax-add-repository можно легко добавлять новые maven2 репозитории:</p>
<div class="highlight"><pre><code class="bash">home:pax-test apanasenko<span class="nv">$ </span>/opt/pax-construct-1.4/bin/pax-add-repository

pax-add-repository -i repositoryId -u repositoryURL <span class="o">[</span>-o<span class="o">]</span> <span class="o">[</span>-- mvnOpts ...<span class="o">]</span>

repositoryId <span class="o">(</span>ops4j.releases<span class="o">)</span> ? 
repositoryURL <span class="o">(</span>http://repository.ops4j.org/maven2/<span class="o">)</span> ? 

<span class="o">[</span>INFO<span class="o">]</span> Scanning <span class="k">for </span>projects...
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Building info.jprogers.pax.test <span class="o">(</span>OSGi project<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span>    task-segment: <span class="o">[</span>org.ops4j:maven-pax-plugin:1.4:add-repository<span class="o">]</span> <span class="o">(</span>aggregator-style<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span>pax:add-repository <span class="o">{</span>execution: default-cli<span class="o">}]</span>
<span class="o">[</span>INFO<span class="o">]</span> Adding repository http://repository.ops4j.org/maven2/ to info.jprogers.pax:pax-test:pom:1.0-SNAPSHOT
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> BUILD SUCCESSFUL
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Total <span class="nb">time</span>: 5 seconds
<span class="o">[</span>INFO<span class="o">]</span> Finished at: Sun Feb 28 19:23:04 MSK 2010
<span class="o">[</span>INFO<span class="o">]</span> Final Memory: 14M/79M
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
</code></pre>
</div><h3>Pax create module</h3>
<p>В этой команде все достаточно просто мы создаем модуль в котором далее будет хранить свои бандлы:</p>
<div class="highlight"><pre><code class="bash">home:pax-test apanasenko<span class="nv">$ </span>/opt/pax-construct-1.4/bin/pax-create-module

pax-create-module <span class="o">[</span>-g groupId<span class="o">]</span> -a modulePath <span class="o">[</span>-v version<span class="o">]</span> <span class="o">[</span>-o<span class="o">]</span> <span class="o">[</span>-- mvnOpts ...<span class="o">]</span>

groupId <span class="o">()</span> ? info.jprogers.pax.test
artifactId <span class="o">(</span>myModule<span class="o">)</span> ? <span class="nb">test</span>
version <span class="o">()</span> ? 

<span class="o">[</span>INFO<span class="o">]</span> Scanning <span class="k">for </span>projects...
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Building info.jprogers.pax.test <span class="o">(</span>OSGi project<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span>    task-segment: <span class="o">[</span>org.ops4j:maven-pax-plugin:1.4:create-module<span class="o">]</span> <span class="o">(</span>aggregator-style<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span>pax:create-module <span class="o">{</span>execution: default-cli<span class="o">}]</span>
<span class="o">[</span>INFO<span class="o">]</span> Created new module /Users/apanasenko/Documents/IdeaProject/paxtest/pax-test/test
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> BUILD SUCCESSFUL
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Total <span class="nb">time</span>: 3 seconds
<span class="o">[</span>INFO<span class="o">]</span> Finished at: Sun Feb 28 19:33:42 MSK 2010
<span class="o">[</span>INFO<span class="o">]</span> Final Memory: 14M/79M
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
home:pax-test apanasenko<span class="nv">$ </span>ls -al
total 8
drwxr-xr-x  6 apanasenko  staff   204 28 фев 19:33 .
drwxr-xr-x  3 apanasenko  staff   102 28 фев 18:59 ..
-rw-r--r--  1 apanasenko  staff  2162 28 фев 19:33 pom.xml
drwxr-xr-x  5 apanasenko  staff   170 28 фев 18:59 poms
drwxr-xr-x  3 apanasenko  staff   102 28 фев 18:59 provision
drwxr-xr-x  3 apanasenko  staff   102 28 фев 19:33 <span class="nb">test</span>
</code></pre>
</div><h3>Pax create bundle</h3>
<p>С помощью этой команды мы можем создавать свои бандлы, которые автоматически добавятся в нужную помку и занаследуют нужный парент артифакт:</p>
<div class="highlight"><pre><code class="bash">home:test apanasenko<span class="nv">$ </span>/opt/pax-construct-1.4/bin/pax-create-bundle

pax-create-bundle -p package <span class="o">[</span>-n bundleName<span class="o">]</span> <span class="o">[</span>-g bundleGroupId<span class="o">]</span> <span class="o">[</span>-v version<span class="o">]</span> <span class="o">[</span>-o<span class="o">]</span> <span class="o">[</span>-- mvnOpts ...<span class="o">]</span>

package <span class="o">(</span>org.example.pkg<span class="o">)</span> ? info.jprogers.pax.test
bundleName <span class="o">()</span> ? pax-test
bundleGroupId <span class="o">()</span> ? info.jprogers.pax.test 
version <span class="o">(</span>1.0-SNAPSHOT<span class="o">)</span> ? 

<span class="o">[</span>INFO<span class="o">]</span> Scanning <span class="k">for </span>projects...
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Building 
<span class="o">[</span>INFO<span class="o">]</span>    task-segment: <span class="o">[</span>org.ops4j:maven-pax-plugin:1.4:create-bundle<span class="o">]</span> <span class="o">(</span>aggregator-style<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Setting property: classpath.resource.loader.class <span class="o">=</span>&gt; <span class="s1">&#39;org.codehaus.plexus.velocity.ContextClassLoaderResourceLoader&#39;</span>.
<span class="o">[</span>INFO<span class="o">]</span> Setting property: velocimacro.messages.on <span class="o">=</span>&gt; <span class="s1">&#39;false&#39;</span>.
<span class="o">[</span>INFO<span class="o">]</span> Setting property: resource.loader <span class="o">=</span>&gt; <span class="s1">&#39;classpath&#39;</span>.
<span class="o">[</span>INFO<span class="o">]</span> Setting property: resource.manager.logwhenfound <span class="o">=</span>&gt; <span class="s1">&#39;false&#39;</span>.
<span class="o">[</span>INFO<span class="o">]</span> ************************************************************** 
<span class="o">[</span>INFO<span class="o">]</span> Starting Jakarta Velocity v1.4
<span class="o">[</span>INFO<span class="o">]</span> RuntimeInstance initializing.
<span class="o">[</span>INFO<span class="o">]</span> Default Properties File: org/apache/velocity/runtime/defaults/velocity.properties
<span class="o">[</span>INFO<span class="o">]</span> Default ResourceManager initializing. <span class="o">(</span>class org.apache.velocity.runtime.resource.ResourceManagerImpl<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> Resource Loader Instantiated: org.codehaus.plexus.velocity.ContextClassLoaderResourceLoader
<span class="o">[</span>INFO<span class="o">]</span> ClasspathResourceLoader : initialization starting.
<span class="o">[</span>INFO<span class="o">]</span> ClasspathResourceLoader : initialization complete.
<span class="o">[</span>INFO<span class="o">]</span> ResourceCache : initialized. <span class="o">(</span>class org.apache.velocity.runtime.resource.ResourceCacheImpl<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> Default ResourceManager initialization complete.
<span class="o">[</span>INFO<span class="o">]</span> Loaded System Directive: org.apache.velocity.runtime.directive.Literal
<span class="o">[</span>INFO<span class="o">]</span> Loaded System Directive: org.apache.velocity.runtime.directive.Macro
<span class="o">[</span>INFO<span class="o">]</span> Loaded System Directive: org.apache.velocity.runtime.directive.Parse
<span class="o">[</span>INFO<span class="o">]</span> Loaded System Directive: org.apache.velocity.runtime.directive.Include
<span class="o">[</span>INFO<span class="o">]</span> Loaded System Directive: org.apache.velocity.runtime.directive.Foreach
<span class="o">[</span>INFO<span class="o">]</span> Created: 20 parsers.
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : initialization starting.
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : adding VMs from VM library template : VM_global_library.vm
<span class="o">[</span>ERROR<span class="o">]</span> ResourceManager : unable to find resource <span class="s1">&#39;VM_global_library.vm&#39;</span> in any resource loader.
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : error using  VM library template VM_global_library.vm : org.apache.velocity.exception.ResourceNotFoundException: Unable to find resource <span class="s1">&#39;VM_global_library.vm&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro :  VM library template macro registration complete.
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : <span class="nv">allowInline</span> <span class="o">=</span> <span class="nb">true</span> : VMs can be defined inline in templates
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : <span class="nv">allowInlineToOverride</span> <span class="o">=</span> <span class="nb">false</span> : VMs defined inline may NOT replace previous VM definitions
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : <span class="nv">allowInlineLocal</span> <span class="o">=</span> <span class="nb">false</span> : VMs defined inline will be  global in scope <span class="k">if </span>allowed.
<span class="o">[</span>INFO<span class="o">]</span> Velocimacro : initialization complete.
<span class="o">[</span>INFO<span class="o">]</span> Velocity successfully started.
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span>pax:create-bundle <span class="o">{</span>execution: default-cli<span class="o">}]</span>
<span class="o">[</span>INFO<span class="o">]</span> Selecting latest archetype release within version range <span class="o">[</span>1,2<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> ----------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Using following parameters <span class="k">for </span>creating Archetype: maven-archetype-osgi-bundle:1.0.3
<span class="o">[</span>INFO<span class="o">]</span> ----------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Parameter: symbolicName, Value: info.jprogers.pax.test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: packageName, Value: info.jprogers.pax.test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: archetypeVersion, Value: 1.0.3
<span class="o">[</span>INFO<span class="o">]</span> Parameter: groupId, Value: info.jprogers.pax.test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: archetypeArtifactId, Value: maven-archetype-osgi-bundle
<span class="o">[</span>INFO<span class="o">]</span> Parameter: version, Value: 1.0-SNAPSHOT
<span class="o">[</span>INFO<span class="o">]</span> Parameter: archetypeGroupId, Value: org.ops4j.pax.construct
<span class="o">[</span>INFO<span class="o">]</span> Parameter: isMultiModuleProject, Value: <span class="nb">true</span>
<span class="o">[</span>INFO<span class="o">]</span> Parameter: basedir, Value: /Users/apanasenko/Documents/IdeaProject/paxtest/pax-test/test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: package, Value: info.jprogers.pax.test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: artifactId, Value: pax-test
<span class="o">[</span>INFO<span class="o">]</span> ********************* End of debug info from resources from generated POM ***********************
<span class="o">[</span>INFO<span class="o">]</span> Archetype created in dir: /Users/apanasenko/Documents/IdeaProject/paxtest/pax-test/test/pax-test
<span class="o">[</span>INFO<span class="o">]</span> ----------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Using following parameters <span class="k">for </span>creating Archetype: maven-archetype-osgi-service:1.0.3
<span class="o">[</span>INFO<span class="o">]</span> ----------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Parameter: symbolicName, Value: info.jprogers.pax.test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: packageName, Value: info.jprogers.pax.test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: archetypeVersion, Value: 1.0.3
<span class="o">[</span>INFO<span class="o">]</span> Parameter: groupId, Value: info.jprogers.pax
<span class="o">[</span>INFO<span class="o">]</span> Parameter: archetypeArtifactId, Value: maven-archetype-osgi-service
<span class="o">[</span>INFO<span class="o">]</span> Parameter: version, Value: 1.0-SNAPSHOT
<span class="o">[</span>INFO<span class="o">]</span> Parameter: archetypeGroupId, Value: org.ops4j.pax.construct
<span class="o">[</span>INFO<span class="o">]</span> Parameter: isMultiModuleProject, Value: <span class="nb">true</span>
<span class="o">[</span>INFO<span class="o">]</span> Parameter: basedir, Value: /Users/apanasenko/Documents/IdeaProject/paxtest/pax-test/test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: package, Value: info.jprogers.pax.test
<span class="o">[</span>INFO<span class="o">]</span> Parameter: artifactId, Value: pax-test
<span class="o">[</span>INFO<span class="o">]</span> ********************* End of debug info from resources from generated POM ***********************
<span class="o">[</span>INFO<span class="o">]</span> Archetype created in dir: /Users/apanasenko/Documents/IdeaProject/paxtest/pax-test/test/pax-test
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> BUILD SUCCESSFUL
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Total <span class="nb">time</span>: 3 seconds
<span class="o">[</span>INFO<span class="o">]</span> Finished at: Sun Feb 28 19:40:53 MSK 2010
<span class="o">[</span>INFO<span class="o">]</span> Final Memory: 16M/79M
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
home:test apanasenko<span class="nv">$ </span>ls -al
total 8
drwxr-xr-x  4 apanasenko  staff  136 28 фев 19:40 .
drwxr-xr-x  6 apanasenko  staff  204 28 фев 19:33 ..
drwxr-xr-x  5 apanasenko  staff  170 28 фев 19:40 pax-test
-rw-r--r--  1 apanasenko  staff  611 28 фев 19:40 pom.xml
</code></pre>
</div><h3>Pax provision</h3>
<p>С помощью этой команды мы можем запустить наш проект либо отдельный бандл. Дефолтным контейнером используеться <b>Apache Felix</b>, но всегда можно поменять на интересующую через тег:</p>
<div class="highlight"><pre><code class="bash">--platform<span class="o">=</span>equinox
</code></pre>
</div><p><br/></p>
<div class="highlight"><pre><code class="bash">home:pax-test apanasenko<span class="nv">$ </span>/opt/pax-construct-1.4/bin/pax-provision
<span class="o">[</span>INFO<span class="o">]</span> Scanning <span class="k">for </span>projects...
<span class="o">[</span>INFO<span class="o">]</span> Reactor build order: 
<span class="o">[</span>INFO<span class="o">]</span>   info.jprogers.pax.test <span class="o">(</span>OSGi project<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span>   pax-test - plugin configuration
<span class="o">[</span>INFO<span class="o">]</span>   pax-test - wrapper instructions
<span class="o">[</span>INFO<span class="o">]</span>   pax-test - bundle instructions
<span class="o">[</span>INFO<span class="o">]</span>   pax-test - imported bundles
<span class="o">[</span>INFO<span class="o">]</span>   info.jprogers.pax.test
<span class="o">[</span>INFO<span class="o">]</span>   
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Building info.jprogers.pax.test <span class="o">(</span>OSGi project<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span>    task-segment: <span class="o">[</span>org.ops4j:maven-pax-plugin:1.4:provision<span class="o">]</span> <span class="o">(</span>aggregator-style<span class="o">)</span>
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span>pax:provision <span class="o">{</span>execution: default-cli<span class="o">}]</span>
<span class="o">[</span>INFO<span class="o">]</span> Installing /Users/apanasenko/Documents/IdeaProject/paxtest/pax-test/runner/deploy-pom.xml to /Users/apanasenko/.m2/repository/info/jprogers/pax/test/build/deployment/1.0-SNAPSHOT/deployment-1.0-SNAPSHOT.pom
<span class="o">[</span>INFO<span class="o">]</span> artifact org.ops4j.pax.runner:pax-runner: checking <span class="k">for </span>updates from ops4j.releases
<span class="o">[</span>INFO<span class="o">]</span> artifact org.ops4j.pax.runner:pax-runner: checking <span class="k">for </span>updates from central
__________                 __________                                 
<span class="se">\_</span>_____   <span class="se">\_</span>____  ___  ___ <span class="se">\_</span>_____   <span class="se">\_</span>_ __  ____   ____   ___________
|     ___/<span class="se">\_</span>_  <span class="se">\ \ </span> <span class="se">\/</span>  /  |       _/  |  <span class="se">\/</span>    <span class="se">\ </span>/    <span class="se">\_</span>/ __ <span class="se">\_</span>  __ <span class="se">\</span>
|    |     / __ <span class="se">\_</span>&gt;    &lt;   |    |   <span class="se">\ </span> |  /   |  <span class="se">\ </span>  |  <span class="se">\ </span> ___/|  | <span class="se">\/</span>
|____|    <span class="o">(</span>____  /__/<span class="se">\_</span> <span class="se">\ </span> |____|_  /____/|___|  /___|  /<span class="se">\_</span>__  &gt;__|   
<span class="se">\/</span>      <span class="se">\/</span>         <span class="se">\/</span>           <span class="se">\/</span>     <span class="se">\/</span>     <span class="se">\/</span>       

Pax Runner <span class="o">(</span>1.4.0<span class="o">)</span> from OPS4J - http://www.ops4j.org
----------------------------------------------------

-&gt; Using config <span class="o">[</span>classpath:META-INF/runner.properties<span class="o">]</span>
-&gt; Using only arguments from <span class="nb">command </span>line
-&gt; Scan bundles from <span class="o">[</span>/Users/apanasenko/Documents/IdeaProject/paxtest/pax-test/runner/deploy-pom.xml<span class="o">]</span>
-&gt; Scan bundles from <span class="o">[</span>scan-pom:file:/Users/apanasenko/Documents/IdeaProject/paxtest/pax-test/runner/deploy-pom.xml<span class="o">]</span>
-&gt; Provision bundle <span class="o">[</span>mvn:info.jprogers.pax.test/pax-test/1.0-SNAPSHOT, at default start level, bundle will be started, bundle will be loaded from the cache<span class="o">]</span>
-&gt; Preparing framework <span class="o">[</span>Felix 2.0.2<span class="o">]</span>
-&gt; Downloading bundles...
-&gt; Felix 2.0.2 : 388030 bytes @ <span class="o">[</span> 16kBps <span class="o">]</span>
-&gt; Felix Shell <span class="o">(</span>1.4.1<span class="o">)</span> : 62616 bytes @ <span class="o">[</span> 13kBps <span class="o">]</span>
-&gt; Felix TUI Shell <span class="o">(</span>1.4.1<span class="o">)</span> : 12748 bytes @ <span class="o">[</span> 20kBps <span class="o">]</span>
-&gt; mvn:info.jprogers.pax.test/pax-test/1.0-SNAPSHOT : 5332 bytes @ <span class="o">[</span> 380kBps <span class="o">]</span>
-&gt; Using execution environment <span class="o">[</span>J2SE-1.6<span class="o">]</span>
-&gt; Runner has successfully finished his job!


Welcome to <span class="nv">Felix</span>
<span class="o">================</span>

-&gt; STARTING info.jprogers.pax.test
REGISTER info.jprogers.pax.test.ExampleService
Command not found.
-&gt; ps
START LEVEL 6
ID   State         Level  Name
<span class="o">[</span>   0<span class="o">]</span> <span class="o">[</span>Active     <span class="o">]</span> <span class="o">[</span>    0<span class="o">]</span> System Bundle <span class="o">(</span>2.0.2<span class="o">)</span>
<span class="o">[</span>   1<span class="o">]</span> <span class="o">[</span>Active     <span class="o">]</span> <span class="o">[</span>    5<span class="o">]</span> info.jprogers.pax.test <span class="o">(</span>1.0.0.SNAPSHOT<span class="o">)</span>
<span class="o">[</span>   2<span class="o">]</span> <span class="o">[</span>Active     <span class="o">]</span> <span class="o">[</span>    1<span class="o">]</span> Apache Felix Shell Service <span class="o">(</span>1.4.1<span class="o">)</span>
<span class="o">[</span>   3<span class="o">]</span> <span class="o">[</span>Active     <span class="o">]</span> <span class="o">[</span>    1<span class="o">]</span> Apache Felix Shell TUI <span class="o">(</span>1.4.1<span class="o">)</span>
-&gt; shutdown
-&gt; STOPPING info.jprogers.pax.test

-&gt; Platform has been shutdown.
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> BUILD SUCCESSFUL
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Total <span class="nb">time</span>: 1 minute 46 seconds
<span class="o">[</span>INFO<span class="o">]</span> Finished at: Sun Feb 28 19:51:56 MSK 2010
<span class="o">[</span>INFO<span class="o">]</span> Final Memory: 15M/79M
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
</code></pre>
</div>

	
		<h4>Posted 28 Feb 2010 by Anton Panasenko | tags:
		 
			
				<a href="/search/label/java">java</a>,
			 
		 
					
				<a href="/search/label/osgi">osgi</a>
			 
		 
			
				and <a href="/search/label/pax">pax</a>.
			 
		
	</h4>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = 'http://dieu.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript">
	$('#main').removeClass('selected');
	$('#post').addClass('selected');
</script>

<!--

-->

	</div>
</div>
<!-- <div id="footer">
	<a href="">Source code</a>
</div> -->

 <script type="text/javascript">
var disqus_shortname = 'dieu';
(function () {
    var s = document.createElement('script'); s.async = true;
    s.src = 'http://disqus.com/forums/dieu/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
 </script>

  
<!-- Yandex.Metrika counter -->
<div style="display:none;"><script type="text/javascript">
(function(w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter445478 = new Ya.Metrika(445478);
             yaCounter445478.clickmap(true);
             yaCounter445478.trackLinks(true);
        
        } catch(e) { }
    });
})(window, 'yandex_metrika_callbacks');
</script></div>
<script src="//mc.yandex.ru/metrika/watch.js" type="text/javascript" defer="defer"></script>
<noscript><img src="//mc.yandex.ru/watch/445478" style="position:absolute; left:-9999px;" alt="" /></noscript>
<!-- /Yandex.Metrika counter -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6891853-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>